<?php
/**
 *  Router dispatcher generated by crodas/Dispatcher
 *
 *  https://github.com/crodas/Dispatcher
 *
 *  This is a generated file, do not modify it.
 */
namespace AllTest;

class NotFoundException extends \Exception 
{
}

class Request
{
    protected $var = array();

    public function setIfEmpty($name, $value)
    {
        if (empty($this->var[$name])) {
            $this->var[$name] = $value;
        }
        return $this;
    }

    public function set($name, $value)
    {
        $this->var[$name] = $value;
        return $this;
    }

    public function get($name)
    {
        if (array_key_exists($name, $this->var)) {
            return $this->var[$name];
        }
        return NULL;
    }
}

class Route
{
    public function fromRequest(Request $req = NULL)
    {
        if (empty($req)) {
            $req = new Request;
        }
        return $this->doRoute($req, $_SERVER);
    }

    public function doRoute(Request $req, $server)
    {
        $parts  = array_values(array_filter(explode("/", $server['REQUEST_URI'])));
        $length = count($parts);

        if (empty($server['REQUEST_METHOD'])) {
            $server['REQUEST_METHOD'] = 'GET';
        }

        switch ($server["REQUEST_METHOD"]) {
        case 'POST':
            switch ($length) {
            case 1:
                // Routes for /prefix/
                if ($parts[0] === 'prefix') {
                    if (empty($file_ce8f643f)) {
                       $file_ce8f643f = 1;
                       require_once __DIR__ . "/../input/class.php";
                    }
                    if (empty($obj_filt_2d89b930)) {
                        $obj_filt_2d89b930 = new \SomeClass;
                    }
                
                    //run preRoute filters (if any)
                    $allow = true;
                    if (empty($file_e0cf7353)) {
                       $file_e0cf7353 = 1;
                       require_once __DIR__ . "/../input/route_filters.php";
                    }
                    if ($allow) {
                        $allow &= \CheckSession($req);
                    }
                
                    // do route
                    if ($allow) {
                        $return = $obj_filt_2d89b930->save($req);
                
                        // post postRoute (if any)
                        $allow = true;
                
                        return $return;
                    }
                }
                // end of /prefix/
                break;
            }
            break;
        }
        
        switch ($length) {
        case 2:
            if ($parts[0] === 'function') {
                if (empty($file_e55749ee)) {
                   $file_e55749ee = 1;
                   require_once __DIR__ . "/../input/filter.php";
                }
                // Routes for /function/{reverse}
                if ($parts[0] === 'function' && (!empty($filter_cab1b2b5_1) || ($filter_cab1b2b5_1=\filter_reverse($req, 'reverse', $parts[1])))) {
                    $req->setIfEmpty('reverse', $parts[1]);
                    if (empty($file_2053a8ae)) {
                       $file_2053a8ae = 1;
                       require_once __DIR__ . "/../input/functions.php";
                    }
                
                    //run preRoute filters (if any)
                    $allow = true;
                
                    // do route
                    if ($allow) {
                        $return = \some_function($req);
                
                        // post postRoute (if any)
                        $allow = true;
                
                        return $return;
                    }
                }
                // end of /function/{reverse}
                
                // Routes for /function/reverse
                if ($parts[0] === 'function' && $parts[1] === 'reverse') {
                    if (empty($file_2053a8ae)) {
                       $file_2053a8ae = 1;
                       require_once __DIR__ . "/../input/functions.php";
                    }
                
                    //run preRoute filters (if any)
                    $allow = true;
                
                    // do route
                    if ($allow) {
                        $return = \some_function($req);
                
                        // post postRoute (if any)
                        $allow = true;
                
                        return $return;
                    }
                }
                // end of /function/reverse
            }
            // Routes for /prefix//some
            if ($parts[0] === 'prefix' && $parts[1] === 'some') {
                if (empty($file_ce8f643f)) {
                   $file_ce8f643f = 1;
                   require_once __DIR__ . "/../input/class.php";
                }
                if (empty($obj_filt_2d89b930)) {
                    $obj_filt_2d89b930 = new \SomeClass;
                }
            
                //run preRoute filters (if any)
                $allow = true;
            
                // do route
                if ($allow) {
                    $return = $obj_filt_2d89b930->index($req);
            
                    // post postRoute (if any)
                    $allow = true;
            
                    return $return;
                }
            }
            // end of /prefix//some
            
            if (empty($file_e55749ee)) {
               $file_e55749ee = 1;
               require_once __DIR__ . "/../input/filter.php";
            }
            // Routes for /ifempty/{something:algo-alias}
            if ($parts[0] === 'ifempty' && (!empty($filter_45a21400_1) || ($filter_45a21400_1=\filter_set($req, 'algo-alias', $parts[1])))) {
                $req->setIfEmpty('algo-alias', $parts[1]);
                if (empty($file_2053a8ae)) {
                   $file_2053a8ae = 1;
                   require_once __DIR__ . "/../input/functions.php";
                }
            
                //run preRoute filters (if any)
                $allow = true;
            
                // do route
                if ($allow) {
                    $return = \some_function($req);
            
                    // post postRoute (if any)
                    $allow = true;
            
                    return $return;
                }
            }
            // end of /ifempty/{something:algo-alias}
            break;
        }

        throw new NotFoundException;
    }
}
